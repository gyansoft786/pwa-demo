import{b as P,c as M}from"./chunk-FIVYFGNT.js";import"./chunk-XAZLOLJU.js";import"./chunk-LX3SISR5.js";import{x as C}from"./chunk-LG33HJ7K.js";import"./chunk-K2WS7XYY.js";import{Cb as f,Eb as d,Ob as q,Pb as _,Tb as v,aa as w,cb as S,f as c,ga as h,ia as D,jb as k,ra as l,sa as m,sb as x,wb as a,xb as s,yb as u,zb as g}from"./chunk-AO5Y7OM7.js";var p=class r{#e=new Worker(new URL("worker-LNRRDJTS.js",import.meta.url),{type:"module"});constructor(){}connectDB(e){return new Promise((t,i)=>{this.#e.postMessage(e),this.#e.onmessage=({data:n})=>{console.log("data received ",n),t(n)}})}runQuery(e){return new Promise((t,i)=>{this.#e.postMessage(e),this.#e.onmessage=({data:n})=>{console.log("data received ",n.data),t(n)}})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=w({token:r,factory:r.\u0275fac,providedIn:"root"})};function W(r,e){if(r&1){let t=g();a(0,"input",2),f("change",function(n){l(t);let o=d();return m(o.onChange(n))}),s()}}function V(r,e){if(r&1){let t=g();a(0,"button",3),f("click",function(){l(t);let n=d();return m(n.connectDb())}),_(1,"Connect"),s(),u(2,"br"),a(3,"mat-form-field",4),u(4,"textarea",5,0),s(),u(6,"br"),a(7,"button",3),f("click",function(){l(t);let n=q(5),o=d();return m(o.runQuery(n.value))}),_(8,"Run Query"),s()}}var F=class r{hasDb=S(!1);sqliteSvc=h(p);ngOnInit(){this.checkDb()}checkDb(){return c(this,null,function*(){try{let t=yield(yield navigator.storage.getDirectory()).getFileHandle("movies.db",{create:!1});this.hasDb.set(!0)}catch(e){console.log(e),this.hasDb.set(!1)}})}connectDb(){return c(this,null,function*(){try{let e={action:"connect",data:{dbName:"movies.db"}};this.sqliteSvc.connectDB(e)}catch(e){console.error(e)}})}onChange(e){let i=e.target.files[0];if(!i)return;let n=new FileReader;n.onload=o=>c(this,null,function*(){let b=o.target?.result;if(b){let T=new Uint8Array(b),y=yield(yield(yield navigator.storage.getDirectory()).getFileHandle(i.name,{create:!0})).createWritable({keepExistingData:!1});yield y.write(T),yield y.close(),this.hasDb.set(!0)}}),n.readAsArrayBuffer(i)}runQuery(e){let t={action:"fetch",data:e};this.sqliteSvc.runQuery(t).then(i=>{console.log(i)})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=D({type:r,selectors:[["app-sqlite"]],standalone:!0,features:[v],decls:2,vars:1,consts:[["queryText",""],["type","file"],["type","file",3,"change"],["mat-flat-button","",3,"click"],[2,"width","500px"],["matInput","","placeholder","Enter query","cols","100","rows","10"]],template:function(t,i){t&1&&k(0,W,1,0,"input",1)(1,V,9,0),t&2&&x(i.hasDb()?1:0)},dependencies:[C,P,M]})};export{F as SqlitePage};
